<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Mathematics Quiz | Chapter 1 Topic 1</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
    margin:0;
    padding:0;
    font-family:"Segoe UI",Arial;
    background:#f7f9ff;
}

.header{
    background:#007bff;
    padding:18px;
    color:white;
    font-size:26px;
}

.quiz-box{
    width:90%;
    max-width:900px;
    background:white;
    margin:25px auto;
    padding:25px;
    border-radius:12px;
    box-shadow:0 4px 18px rgba(0,0,0,0.2);
}

.option{
    padding:12px;
    background:#eef4ff;
    margin:10px 0;
    border-radius:8px;
    cursor:pointer;
}
.option:hover{
    background:#dbe8ff;
}

button{
    padding:12px 18px;
    border:none;
    background:#007bff;
    color:white;
    border-radius:8px;
    cursor:pointer;
    margin-top:15px;
}

.nav-btns{
    display:flex;
    justify-content:space-between;
    margin-top:25px;
}
</style>
</head>
<script src="/Quizzone/Global/loader.js"></script>
<script src="/Quizzone/Global/seoMeta.js"></script>
<script src="https://akshat-881236.github.io/TrackerJS/tracker.js"></script>
<script src="https://akshat-881236.github.io/TrackerJS/ui.js"></script>
<script src="https://akshat-881236.github.io/TrackerJS/index.js"></script>
<script src="https://akshat-881236.github.io/TrackerJS/trackermeta.js"></script>
<body onload="pushData()">

<div class="header">Mathematics ‚Üí Chapter 1 ‚Üí Quiz Topic 1</div>

<div class="quiz-box">

    <h2 id="questionText"></h2>

    <div id="options"></div>

    <button onclick="nextQuestion()">Next ‚Üí</button>
</div>

 <div class="nav-btns">
        <button onclick="previous()">‚Üê Previous Topic</button>
        <button onclick="next()">Next Topic ‚Üí</button>
    </div>

<script>

    /* -----------------------------------------------
   CHECK LOGIN STATUS
-------------------------------------------------- */
let user = JSON.parse(localStorage.getItem("ActiveQuizzoneUser"));

if (!user) {
    alert("Please login first!");
    window.location.href = "/Quizzone/Home/SignIn.htm";
}

// ---------------- QUESTIONS ----------------
const questions = [
    {
      q: "Which number system includes 0?",
      opt: ["Natural", "Whole", "Rational", "Irrational"],
      ans: 1
    },
    {
      q:"Integers include:",
      opt:["Only positive", "Only negative", "Both positive & negative", "Fractions"],
      ans:2
    },
    {
      q:"Which is a rational number?",
      opt:["‚àö2","œÄ","7/3","0.333... non repeating"],
      ans:2
    }
];

let index = 0;
let score = 0;

loadQuestion();

// ---------------- LOAD QUESTION ----------------
function loadQuestion(){
    document.getElementById("questionText").innerText = questions[index].q;

    let opts = "";
    questions[index].opt.forEach((o,i)=>{
        opts += `<div class='option' onclick='check(${i})'>${o}</div>`;
    });

    document.getElementById("options").innerHTML = opts;
}

// ---------------- CHECK ANSWER ----------------
function check(i){
    if(i === questions[index].ans){
        score += 4;
    } else {
        score -= 1;
    }
    nextQuestion();
}

// ---------------- NEXT QUESTION ----------------
function nextQuestion(){
    index++;
    if(index >= questions.length){
        finishQuiz();
        return;
    }
    loadQuestion();
}

// ---------------- FINISH QUIZ ----------------
function finishQuiz(){
    let box = document.querySelector(".quiz-box");
    box.innerHTML = `
        <h2>Quiz Completed üéâ</h2>
        <h3>Your Score: ${score}</h3>
        <button onclick='saveScore()'>Save Score</button>
    `;
}

// ---------------- SAVE SCORE TO LOCAL STORAGE ----------------
function saveScore(){
    let user = JSON.parse(localStorage.getItem("ActiveQuizzoneUser"));
    if(!user){ alert("Login Required!"); return; }

    user.scores.math_ch1_t1 = score;

    localStorage.setItem("ActiveQuizzoneUser", JSON.stringify(user));

    let allUsers = JSON.parse(localStorage.getItem("QuizzoneUsersDB"));
    let idx = allUsers.findIndex(x=>x.email===user.email);
    allUsers[idx] = user;
    localStorage.setItem("QuizzoneUsersDB",JSON.stringify(allUsers));

    alert("Score Saved Successfully!");
    next();
}

function getPageNumber() {
    const url = window.location.pathname;
    const match = url.match(/Topic(\d+)\.htm/);
    return match ? parseInt(match[1]) : null;
}

function navigateToPage(num) {
    fetch(`Topic${num}.htm`).then(response => {
        if (response.ok) {
            window.location.href = `Topic${num}.htm`;
        } else {
            console.error(`Page Topic${num}.htm not found`);
            alert(`Page Topic${num}.htm not found`);
        }
    })
    .catch(error => {
        console.error(`Error navigating to page: ${error}`);
    });
}

function previous(){
    const currentPage = getPageNumber();
    if (currentPage > 1) {
        navigateToPage(currentPage - 1);
    } else {
        console.log('You are on the first page');
        alert('You are on the first page');
    }
}

function next(){
    const currentPage = getPageNumber();
    fetch(`Topic${currentPage + 1}.htm`).then(response => {
        if (response.ok) {
            navigateToPage(currentPage + 1);
        } else {
            console.log('You are on the last page');
            alert('You are on the last page');
        }
    })
    .catch(error => {
        console.error(`Error checking next page: $(error)`);
    });
}

fetch(window.location.href)
  .then(res => {
    if (!res.ok) window.location.href = "/Quizzone/Errors/404.htm";
  })
  .catch(() => window.location.href = "/Quizzone/Errors/404.htm");

</script>

</body>
</html>